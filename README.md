# HPC-Security-Dashboard-Falco
This repository is part of the HPC Security Dashboard project developed as part of the **HPE CTY'23** program under the mentorship of Yarlagadda Srinivasa Rao. The team members include Swayam Mehta (Me), Alok N, Arka Pramanik, Nishanth VM and Keshav Varshney. Together we have worked on various aspects of Cloud Native Security like static code analysis, build-time and runtime security. We have focused on the following tools for securing our Kubernetes environment:
<ul>
  <li>Falco</li>
  <li>Kubescape</li>
  <li>Kube-bench</li>
  <li>Kube-hunter</li>
  <li>Cilium</li>
</ul>
We have further developed custom Grafana dashboards for easy understanding of metrics that each of these tools provide in order to help professionals make well-informed decisions on security measures. This repository focuses specifically on Sysdig's Falco security tool.

You can follow the <a href="setup.md">setup guide</a> to easily deploy a K8s cluster, Prometheus Monitoring, Grafana and Falco. You will be able to capture all suspicious Falco events and visualize the metrics on a Grafana dashboard customized specially for Falco.   

# Falco
Falco is an open-source cloud-native runtime security tool designed to monitor and detect abnormal activities within containerized environments, such as Kubernetes. It was created by Sysdig, a company specializing in container security and monitoring. Falco focuses on providing real-time visibility and alerting for potential security issues and policy violations. It leverages system calls and kernel-level instrumentation to gain deep insights into the behavior of applications and processes running within containers.

Key features of Falco include:
1. ***Container Runtime Security***: Falco monitors system calls and other low-level events to detect anomalous behavior and potential security threats. It can identify activities such as file access, process execution, network connections, and privilege escalations.
2. ***Rule-Based Detection***: Falco uses a set of customizable rules to define security policies and detect suspicious activities. These rules are written in a simple declarative language and can be tailored to match specific use cases and requirements.
3. ***Real-Time Alerts***: When Falco detects a violation of a defined security rule, it generates real-time alerts. These alerts can be sent to various output channels, including logs, external systems like SIEM (Security Information and Event Management) tools, or even to communication platforms like Slack.
4. ***Rich Metadata***: Falco captures rich metadata associated with security events, including contextual information about the container, the host system, the user, and other relevant details. This information aids in the investigation and analysis of security incidents.
5. ***Extensibility***: Falco is highly extensible and can be integrated with other security tools and frameworks. It provides a plugin system that allows users to extend its functionality and integrate with external services and data sources.

Falco is widely used in cloud-native and containerized environments to enhance security monitoring and incident response capabilities. It helps organizations detect and respond to potential threats and policy violations, thus improving the overall security posture of their containerized applications.

# Architecture
![Falco Architecture](https://github.com/SwayamMehta10/HPC-Security-Dashboard-Falco/assets/79704715/6075558d-8bc1-4716-9b74-f1e4a2796d43)

Let's dive into the detailed Falco architecture:
1. **Falco Components**:
<ul>
  <li><i>Falco Engine</i>: The core component of Falco is the Falco engine, which runs as a daemon or sidecar on each node within a Kubernetes cluster. It leverages the Linux kernel's eBPF (extended Berkeley Packet Filter) technology to monitor system calls and other low-level events.</li>
  <li><i>Rules Engine</i>: Falco utilizes a rules engine to define security policies and detect suspicious activities. The rules are written in a simple declarative language and specify conditions that trigger alerts. For example, a rule might detect a process attempting to access sensitive files or a container making unusual network connections.</li>
  <li><i>Event Stream</i>: Falco captures events generated by the kernel and the container runtime, such as system calls, process creations, file access, and network activity. These events are processed by the rules engine to determine if any security violations have occurred.</li>
  <li><i>Alerting</i>: When Falco detects a security rule violation, it generates real-time alerts. These alerts contain detailed information about the violated rule, the process or container involved, and additional context such as the user and the host system. By default, Falco outputs alerts to the standard output (stdout) or system logs.</li>
</ul>

2. **Integrating with Kubernetes**:
Falco can be deployed as a DaemonSet within a Kubernetes cluster, ensuring that an instance runs on every node. Alternatively, it can be deployed as a sidecar container alongside application containers within pods. When running within a Kubernetes environment, Falco automatically detects and captures events related to container activity, such as process creation, file access, and network connections. It leverages Kubernetes APIs and metadata to enrich the captured events with contextual information, such as the namespace, pod, and container name.

3. **Falco Exporter**:
Falco Exporter is an additional component that collects and exports Falco alerts to external systems or tools for further processing or analysis. It listens for alerts generated by Falco and converts them into a format suitable for consumption by other systems, such as Prometheus. Falco Exporter can be configured to export alerts to various destinations, including log files, external SIEM (Security Information and Event Management) tools, or monitoring systems.

4. **Prometheus and Grafana Integration**:
Prometheus is a monitoring and alerting tool that collects and stores time-series data. It has a flexible data model and provides a query language to retrieve and analyze metrics. This allows for historical analysis and long-term storage of security events. Grafana is a data visualization and analytics platform that integrates with Prometheus. It provides a user-friendly interface for creating dashboards and visualizations based on the data stored in Prometheus. Using Grafana, users can connect to Prometheus, query the Falco alert metrics, and create custom dashboards to visualize the security events captured by Falco. This enables security teams to gain insights, identify trends, and monitor the container runtime security of their Kubernetes clusters.

# Dashboard
This is what our Grafana dashboard will look like:
![VirtualBox_myVM_30_05_2023_13_48_58 (1)](https://github.com/SwayamMehta10/HPC-Security-Dashboard-Falco/assets/79704715/9d41e588-7c7f-4cd3-b4b0-ef08ae3878e8)
